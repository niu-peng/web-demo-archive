<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="../favicon.ico" type="image/png">
    <title>MongoDB å¿«é€Ÿä¸Šæ‰‹æŒ‡å—</title>
    <style>
        /* å…¨å±€æ ·å¼é‡ç½® */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
        }

        /* èƒŒæ™¯æ¸å˜ */
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        /* å®¹å™¨æ ·å¼ */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* æ ‡é¢˜æ ·å¼ */
        h1 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            color: white;
            text-align: center;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        h2 {
            font-size: 2rem;
            margin: 30px 0 15px;
            color: white;
            border-bottom: 2px solid rgba(255, 255, 255, 0.2);
            padding-bottom: 10px;
        }

        h3 {
            font-size: 1.5rem;
            margin: 25px 0 10px;
            color: white;
        }

        /* æ®µè½æ ·å¼ */
        p {
            margin: 15px 0;
            line-height: 1.8;
            color: rgba(255, 255, 255, 0.9);
        }

        /* åˆ—è¡¨æ ·å¼ */
        ul, ol {
            margin: 15px 0;
            padding-left: 30px;
            color: rgba(255, 255, 255, 0.9);
        }

        li {
            margin: 8px 0;
            line-height: 1.6;
        }

        /* è¡¨æ ¼æ ·å¼ */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            overflow: hidden;
        }

        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.9);
        }

        th {
            background: rgba(255, 255, 255, 0.2);
            font-weight: 600;
        }

        tr:last-child td {
            border-bottom: none;
        }

        /* ä»£ç å—æ ·å¼ */
        pre {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 10px;
            padding: 20px;
            overflow-x: auto;
            margin: 20px 0;
            font-family: 'Courier New', Courier, monospace;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        code {
            font-family: 'Courier New', Courier, monospace;
            background: rgba(0, 0, 0, 0.2);
            padding: 2px 6px;
            border-radius: 4px;
            color: #e0f7fa;
        }

        pre code {
            background: none;
            padding: 0;
            border-radius: 0;
        }

        /* å¼•ç”¨æ ·å¼ */
        blockquote {
            border-left: 4px solid rgba(255, 255, 255, 0.5);
            padding-left: 15px;
            margin: 20px 0;
            color: rgba(255, 255, 255, 0.8);
            font-style: italic;
        }

        /* å›åˆ°é¡¶éƒ¨æŒ‰é’® */
        .back-to-top {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
            font-size: 20px;
        }

        .back-to-top:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-5px);
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }

            h1 {
                font-size: 2rem;
            }

            h2 {
                font-size: 1.5rem;
            }

            h3 {
                font-size: 1.2rem;
            }

            table {
                font-size: 14px;
            }

            th, td {
                padding: 8px 10px;
            }
        }

        @media (max-width: 480px) {
            body {
                padding: 10px;
            }

            .container {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“˜ MongoDB å¿«é€Ÿä¸Šæ‰‹æŒ‡å—</h1>
        <p>æœ¬æŒ‡å—æ—¨åœ¨å¸®åŠ©æ‚¨å¿«é€Ÿç†è§£ MongoDB çš„æ ¸å¿ƒæ¦‚å¿µã€æŒæ¡å•æœºéƒ¨ç½²æ–¹æ³•ä»¥åŠå¸¸ç”¨çš„åŸºæœ¬æ“ä½œå‘½ä»¤ï¼ˆCRUDã€ç´¢å¼•ç®¡ç†ï¼‰ã€‚</p>

        <h2>1. MongoDB æ ¸å¿ƒæ¦‚å¿µ</h2>
        
        <h3>1.1 ç®€ä»‹</h3>
        <p>MongoDB æ˜¯ä¸€ä¸ªå¼€æºã€é«˜æ€§èƒ½ã€æ— æ¨¡å¼ï¼ˆSchema-freeï¼‰çš„æ–‡æ¡£å‹æ•°æ®åº“ã€‚å®ƒæ˜¯ NoSQL æ•°æ®åº“äº§å“ä¸­çš„ä¸€ç§ï¼Œä»¥å…¶çµæ´»çš„æ•°æ®ç»“æ„å’Œæ˜“äºæ‰©å±•çš„ç‰¹æ€§è€Œé—»åã€‚</p>
        <ul>
            <li><strong>æ•°æ®æ ¼å¼</strong>: MongoDB é‡‡ç”¨ç±»ä¼¼äº JSON çš„ <strong>BSON (Binary JSON)</strong> æ ¼å¼å­˜å‚¨æ•°æ®ï¼Œå®ƒæ”¯æŒå†…åµŒæ–‡æ¡£å’Œæ•°ç»„å¯¹è±¡ï¼Œå…·æœ‰è½»é‡æ€§ã€å¯éå†æ€§å’Œé«˜æ•ˆæ€§ã€‚</li>
            <li><strong>æ•°æ®å•ä½</strong>: æœ€å°å­˜å‚¨å•ä½æ˜¯<strong>æ–‡æ¡£ (Document)</strong>ï¼Œå®ƒå¯¹åº”äºå…³ç³»å‹æ•°æ®åº“ä¸­çš„â€œè¡Œâ€ã€‚</li>
        </ul>

        <h3>1.2 ä½“ç³»ç»“æ„å¯¹æ¯” (MySQL vs MongoDB)</h3>
        <table>
            <tr>
                <th>SQL æœ¯è¯­/æ¦‚å¿µ</th>
                <th>MongoDB æœ¯è¯­/æ¦‚å¿µ</th>
                <th>è§£é‡Š/è¯´æ˜</th>
            </tr>
            <tr>
                <td><code>database</code></td>
                <td><code>database</code></td>
                <td>æ•°æ®åº“</td>
            </tr>
            <tr>
                <td><code>table</code></td>
                <td><code>collection</code></td>
                <td>æ•°æ®åº“è¡¨/é›†åˆ</td>
            </tr>
            <tr>
                <td><code>row</code></td>
                <td><code>document</code></td>
                <td>æ•°æ®è®°å½•è¡Œ/æ–‡æ¡£</td>
            </tr>
            <tr>
                <td><code>column</code></td>
                <td><code>field</code></td>
                <td>æ•°æ®å­—æ®µ/åŸŸ</td>
            </tr>
            <tr>
                <td><code>primary key</code></td>
                <td><code>primary key</code> (<code>_id</code>)</td>
                <td>ä¸»é”®ï¼ŒMongoDB è‡ªåŠ¨å°† <code>_id</code> å­—æ®µè®¾ç½®ä¸ºä¸»é”®</td>
            </tr>
            <tr>
                <td><code>table joins</code></td>
                <td>(ä¸æ”¯æŒ)</td>
                <td>MongoDB é€šè¿‡<strong>åµŒå…¥æ–‡æ¡£</strong>æ¥æ›¿ä»£å¤šè¡¨è¿æ¥</td>
            </tr>
        </table>

        <h3>1.3 ä¸šåŠ¡åº”ç”¨åœºæ™¯</h3>
        <p>MongoDB èƒ½å¤Ÿåº”å¯¹ä¼ ç»Ÿå…³ç³»å‹æ•°æ®åº“åœ¨â€œä¸‰é«˜â€éœ€æ±‚é¢å‰çš„åŠ›ä¸ä»å¿ƒã€‚</p>
        <p><strong>â€œä¸‰é«˜â€éœ€æ±‚è§£é‡Š</strong>:</p>
        <ul>
            <li><strong>High Performance</strong>: å¯¹æ•°æ®åº“é«˜å¹¶å‘è¯»å†™çš„éœ€æ±‚ã€‚</li>
            <li><strong>Huge Storage</strong>: å¯¹æµ·é‡æ•°æ®çš„é«˜æ•ˆç‡å­˜å‚¨å’Œè®¿é—®çš„éœ€æ±‚ã€‚</li>
            <li><strong>High Scalability & High Availability</strong>: å¯¹æ•°æ®åº“çš„é«˜å¯æ‰©å±•æ€§å’Œé«˜å¯ç”¨æ€§çš„éœ€æ±‚ã€‚</li>
        </ul>
        <p><strong>å…·ä½“çš„åº”ç”¨åœºæ™¯åŒ…æ‹¬</strong>:</p>
        <ol>
            <li><strong>ç¤¾äº¤åœºæ™¯</strong>: å­˜å‚¨ç”¨æˆ·ä¿¡æ¯ï¼Œåˆ©ç”¨åœ°ç†ä½ç½®ç´¢å¼•å®ç°â€œé™„è¿‘çš„äººâ€åŠŸèƒ½ã€‚</li>
            <li><strong>æ¸¸æˆåœºæ™¯</strong>: å­˜å‚¨æ¸¸æˆç”¨æˆ·ä¿¡æ¯ã€è£…å¤‡ã€ç§¯åˆ†ç­‰ï¼Œä»¥å†…åµŒæ–‡æ¡£å½¢å¼å­˜å‚¨ï¼Œæ–¹ä¾¿æŸ¥è¯¢ã€‚</li>
            <li><strong>ç‰©æµåœºæ™¯</strong>: å­˜å‚¨ä¸æ–­æ›´æ–°çš„è®¢å•çŠ¶æ€ï¼Œä½¿ç”¨å†…åµŒæ•°ç»„å­˜å‚¨æ‰€æœ‰å˜æ›´è®°å½•ï¼Œä¸€æ¬¡æŸ¥è¯¢å³å¯è¯»å–ã€‚</li>
            <li><strong>ç‰©è”ç½‘/è§†é¢‘ç›´æ’­</strong>: å­˜å‚¨æ™ºèƒ½è®¾å¤‡ä¿¡æ¯ã€è®¾å¤‡æ—¥å¿—ã€ç‚¹èµäº’åŠ¨ä¿¡æ¯ç­‰ã€‚</li>
        </ol>

        <h3>1.4 ä¸»è¦ç‰¹ç‚¹</h3>
        <ol>
            <li><strong>é«˜æ€§èƒ½</strong>: æ”¯æŒåµŒå…¥å¼æ•°æ®æ¨¡å‹ã€å¤šç§ç´¢å¼•ç±»å‹ï¼ˆæ–‡æœ¬ã€TTLã€åœ°ç†ä½ç½®ï¼‰ä»¥åŠ Gridfs è§£å†³æ–‡ä»¶å­˜å‚¨é—®é¢˜ã€‚</li>
            <li><strong>é«˜å¯ç”¨æ€§</strong>: é€šè¿‡<strong>å‰¯æœ¬é›† (replica set)</strong> æä¾›è‡ªåŠ¨æ•…éšœè½¬ç§»å’Œæ•°æ®å†—ä½™ã€‚</li>
            <li><strong>é«˜æ‰©å±•æ€§</strong>: é€šè¿‡<strong>åˆ†ç‰‡ (sharding)</strong> å°†æ•°æ®åˆ†å¸ƒåœ¨é›†ç¾¤æœºå™¨ä¸Šï¼Œå®ç°æ°´å¹³å¯æ‰©å±•æ€§ã€‚</li>
            <li><strong>ä¸°å¯Œçš„æŸ¥è¯¢æ”¯æŒ</strong>: æ”¯æŒ CRUD æ“ä½œã€æ•°æ®èšåˆã€æ–‡æœ¬æœç´¢å’Œåœ°ç†ç©ºé—´æŸ¥è¯¢ã€‚</li>
        </ol>

        <h2>2. å•æœºéƒ¨ç½²</h2>

        <h3>2.1 Windows ç³»ç»Ÿä¸­çš„å®‰è£…å¯åŠ¨</h3>
        <ol>
            <li><strong>ä¸‹è½½å®‰è£…åŒ…</strong>: ä» <a href="https://www.mongodb.com/download-center#community" style="color: rgba(255, 255, 255, 0.8);">MongoDB å®˜ç½‘</a> ä¸‹è½½é¢„ç¼–è¯‘çš„ ZIP åŒ…ï¼ˆä»¥ç¨³å®šç‰ˆä¸ºå‡†ï¼Œå¦‚ <code>x.y.z</code> ä¸­ <code>y</code> ä¸ºå¶æ•°ï¼‰ã€‚</li>
            <li><strong>è§£å‹ä¸ç›®å½•åˆ›å»º</strong>: å°†å‹ç¼©åŒ…è§£å‹ï¼Œå¹¶åœ¨è§£å‹ç›®å½•ä¸­æ‰‹åŠ¨åˆ›å»ºæ•°æ®å­˜æ”¾ç›®å½•ï¼Œå¦‚ <code>data/db</code>ã€‚</li>
            <li><strong>å¯åŠ¨æœåŠ¡ (æ–¹å¼ä¸€: å‘½ä»¤è¡Œå‚æ•°)</strong>:
                <p>åœ¨ <code>bin</code> ç›®å½•ä¸­æ‰“å¼€å‘½ä»¤è¡Œï¼Œè¾“å…¥ä»¥ä¸‹å‘½ä»¤å¯åŠ¨æœåŠ¡ï¼š</p>
                <pre><code>mongod --dbpath=..\data\db</code></pre>
                <p>MongoDB çš„é»˜è®¤ç«¯å£æ˜¯ <strong>27017</strong>ã€‚</p>
            </li>
            <li><strong>å¯åŠ¨æœåŠ¡ (æ–¹å¼äºŒ: é…ç½®æ–‡ä»¶)</strong>:
                <p>åœ¨è§£å‹ç›®å½•ä¸­æ–°å»º <code>config</code> æ–‡ä»¶å¤¹ï¼Œåˆ›å»ºé…ç½®æ–‡ä»¶ <code>mongod.conf</code>ï¼Œå¹¶ä½¿ç”¨è¯¥æ–‡ä»¶å¯åŠ¨ï¼š</p>
                <pre><code># mongod.conf ç¤ºä¾‹é…ç½®
storage:
    dbPath: &lt;ä½ çš„æ•°æ®ç›®å½•è·¯å¾„&gt; # ä¾‹å¦‚ D:\mongodb\data\db
net:
    port: 27017
# å¯åŠ¨å‘½ä»¤
mongod -f ../config/mongod.conf</code></pre>
                <p>æ³¨æ„ï¼šé…ç½®è·¯å¾„ä¸­å¦‚æœä½¿ç”¨ Windows åæ–œæ  <code>\</code>ï¼Œéœ€è¦å°†å…¶è½¬æ¢ä¸º <code>/</code> æˆ– <code>\\</code> ä»¥é¿å…è½¬ä¹‰é”™è¯¯ã€‚</p>
            </li>
        </ol>

        <h3>2.2 Shell è¿æ¥ä¸ç®¡ç†</h3>
        <p>åœ¨å®‰è£…ç›®å½•çš„ <code>bin</code> ç›®å½•ä¸­ï¼Œå¯ä»¥ä½¿ç”¨ <code>mongo</code> å‘½ä»¤è¿æ¥æœåŠ¡ï¼š</p>
        <ol>
            <li><strong>è¿æ¥æœåŠ¡</strong>:
                <pre><code>mongo
# æˆ–æŒ‡å®šåœ°å€å’Œç«¯å£
mongo --host 127.0.0.1 --port 27017</code></pre>
                <p>MongoDB Shell æ˜¯ä¸€ä¸ªåŸºäº JavaScript çš„è§£é‡Šå™¨ï¼Œæ”¯æŒ JS ç¨‹åºã€‚</p>
            </li>
            <li><strong>æŸ¥çœ‹æ•°æ®åº“</strong>:
                <pre><code>show dbs
# æˆ–
show databases</code></pre>
                <p>é»˜è®¤æ•°æ®åº“æ˜¯ <code>test</code>ã€‚</p>
            </li>
            <li><strong>é€€å‡º</strong>:
                <pre><code>exit</code></pre>
            </li>
        </ol>

        <h3>2.3 Compass å›¾å½¢åŒ–ç•Œé¢å®¢æˆ·ç«¯</h3>
        <p>MongoDB Compass æ˜¯å®˜æ–¹æä¾›çš„å›¾å½¢åŒ–ç®¡ç†ç•Œé¢ï¼Œå¯ç”¨äºè¿æ¥ã€æŸ¥è¯¢å’Œç®¡ç† MongoDBã€‚</p>
        <ul>
            <li><strong>ä½¿ç”¨æ–¹å¼</strong>: æ‰“å¼€ Compass ç•Œé¢ï¼Œè¾“å…¥ä¸»æœºåœ°å€å’Œç«¯å£ï¼ˆå¦‚ <code>localhost:27017</code>ï¼‰ï¼Œç‚¹å‡»è¿æ¥å³å¯ã€‚</li>
        </ul>

        <h3>2.4 Linux ç³»ç»Ÿä¸­çš„å®‰è£…å¯åŠ¨å’Œè¿æ¥ (å•æœºéƒ¨ç½²)</h3>
        <ol>
            <li><strong>å‡†å¤‡ç¯å¢ƒ</strong>: ä¸Šä¼ å¹¶è§£å‹å‹ç¼©åŒ…ï¼Œç§»åŠ¨åˆ°æŒ‡å®šç›®å½•ï¼Œå¦‚ <code>/usr/local/mongodb</code>ã€‚</li>
            <li><strong>åˆ›å»ºç›®å½•</strong>: æ–°å»ºæ•°æ®å­˜å‚¨ç›®å½•å’Œæ—¥å¿—å­˜å‚¨ç›®å½•
                <pre><code>mkdir -p /mongodb/single/data/db  # æ•°æ®å­˜å‚¨ç›®å½•
mkdir -p /mongodb/single/log      # æ—¥å¿—å­˜å‚¨ç›®å½•</code></pre>
            </li>
            <li><strong>é…ç½®æ–‡ä»¶</strong>: åˆ›å»ºå¹¶ä¿®æ”¹ <code>/mongodb/single/mongod.conf</code> é…ç½®æ–‡ä»¶
                <pre><code>systemLog:
  destination: file
  path: "/mongodb/single/log/mongod.log" # æ—¥å¿—æ–‡ä»¶è·¯å¾„
  logAppend: true # é‡å¯æ—¶é™„åŠ åˆ°ç°æœ‰æ—¥å¿—æ–‡ä»¶æœ«å°¾
storage:
  dbPath: "/mongodb/single/data/db" # æ•°æ®å­˜å‚¨ç›®å½•
  journal:
    enabled: true # å¯ç”¨æŒä¹…æ€§æ—¥å¿—
processManagement:
  fork: true # å¯ç”¨å®ˆæŠ¤è¿›ç¨‹æ¨¡å¼ï¼Œåå°è¿è¡Œ
net:
  bindIp: localhost, 192.168.0.2 # ç»‘å®šçš„ IPï¼Œé»˜è®¤ localhost
  port: 27017 # ç«¯å£</code></pre>
            </li>
            <li><strong>å¯åŠ¨æœåŠ¡</strong>:
                <pre><code>/usr/local/mongodb/bin/mongod -f /mongodb/single/mongod.conf</code></pre>
                <p>å¯åŠ¨æˆåŠŸä¼šæ˜¾ç¤º <code>child process started successfully, parent exiting</code>ã€‚</p>
            </li>
            <li><strong>åœæ­¢æœåŠ¡ (æ ‡å‡†å…³é—­)</strong>:
                <p>æ ‡å‡†å…³é—­ä¸æ˜“å‡ºé”™ï¼Œé€šè¿‡å®¢æˆ·ç«¯æ‰§è¡Œå‘½ä»¤</p>
                <pre><code># 1. å®¢æˆ·ç«¯ç™»å½•
mongo --port 27017
# 2. åˆ‡æ¢åˆ° admin åº“
use admin
# 3. å…³é—­æœåŠ¡
db.shutdownServer()</code></pre>
            </li>
        </ol>

        <h2>3. åŸºæœ¬å¸¸ç”¨å‘½ä»¤ (CRUD)</h2>
        
        <h3>3.1 æ•°æ®åº“æ“ä½œ</h3>
        <table>
            <tr>
                <th>å‘½ä»¤</th>
                <th>æè¿°</th>
            </tr>
            <tr>
                <td><code>use articledb</code></td>
                <td>é€‰æ‹©æˆ–åˆ›å»ºæ•°æ®åº“ <code>articledb</code></td>
            </tr>
            <tr>
                <td><code>show dbs</code></td>
                <td>æŸ¥çœ‹æ‰€æœ‰æ•°æ®åº“</td>
            </tr>
            <tr>
                <td><code>db</code></td>
                <td>æŸ¥çœ‹å½“å‰æ­£åœ¨ä½¿ç”¨çš„æ•°æ®åº“</td>
            </tr>
            <tr>
                <td><code>db.dropDatabase()</code></td>
                <td>åˆ é™¤å½“å‰æ­£åœ¨ä½¿ç”¨çš„æ•°æ®åº“ (åˆ é™¤å·²æŒä¹…åŒ–çš„æ•°æ®åº“)</td>
            </tr>
        </table>

        <h3>3.2 é›†åˆæ“ä½œ</h3>
        <table>
            <tr>
                <th>å‘½ä»¤</th>
                <th>æè¿°</th>
            </tr>
            <tr>
                <td><code>db.createCollection("mycollection")</code></td>
                <td>æ˜¾å¼åˆ›å»ºä¸€ä¸ªé›†åˆï¼ˆä¸å¸¸ç”¨ï¼‰</td>
            </tr>
            <tr>
                <td><code>db.comment.insert({...})</code></td>
                <td>éšå¼åˆ›å»ºé›†åˆï¼šåœ¨é¦–æ¬¡æ’å…¥æ–‡æ¡£æ—¶ï¼Œå¦‚æœé›†åˆä¸å­˜åœ¨ä¼šè‡ªåŠ¨åˆ›å»º</td>
            </tr>
            <tr>
                <td><code>show collections</code></td>
                <td>æŸ¥çœ‹å½“å‰æ•°æ®åº“ä¸­çš„æ‰€æœ‰é›†åˆ</td>
            </tr>
            <tr>
                <td><code>db.comment.drop()</code></td>
                <td>åˆ é™¤ <code>comment</code> é›†åˆ</td>
            </tr>
        </table>

        <h3>3.3 æ–‡æ¡£åŸºæœ¬ CRUD</h3>
        
        <h4>3.3.1 æ’å…¥æ–‡æ¡£ (Create)</h4>
        <p><strong>å•ä¸ªæ’å…¥</strong>:</p>
        <pre><code>db.comment.insert({
    "articleid": "100000",
    "content": "ä»Šå¤©å¤©æ°”çœŸå¥½,é˜³å…‰æ˜åªš",
    "userid": "1001",
    "nickname": "Rose",
    "createdatetime": new Date(),  // æ’å…¥å½“å‰æ—¥æœŸ
    "likenum": NumberInt(10),      // æ’å…¥æ•´å‹æ•°å­—
    "state": null
})</code></pre>
        <p><strong>æ³¨æ„</strong>: é»˜è®¤æ•°å­—ç±»å‹æ˜¯ <code>double</code>ï¼Œæ•´å‹éœ€ä½¿ç”¨ <code>NumberInt(value)</code> æˆ– <code>NumberLong(value)</code>ã€‚</p>
        
        <p><strong>æ‰¹é‡æ’å…¥</strong>:</p>
        <pre><code>db.comment.insertMany([
    { "_id": "1", "content": "è¯„è®º 1...", "userid": "1002" },
    { "_id": "2", "content": "è¯„è®º 2...", "userid": "1005" }
])</code></pre>

        <h4>3.3.2 æŸ¥è¯¢æ–‡æ¡£ (Retrieve)</h4>
        <table>
            <tr>
                <th>å‘½ä»¤</th>
                <th>æè¿°</th>
                <th>ç¤ºä¾‹</th>
            </tr>
            <tr>
                <td><code>db.collection.find()</code></td>
                <td>æŸ¥è¯¢æ‰€æœ‰æ–‡æ¡£</td>
                <td><code>db.comment.find()</code></td>
            </tr>
            <tr>
                <td><code>db.collection.find({&lt;query&gt;})</code></td>
                <td>æŒ‰æ¡ä»¶æŸ¥è¯¢</td>
                <td><code>db.comment.find({userid:"1003"})</code></td>
            </tr>
            <tr>
                <td><code>db.collection.findOne({&lt;query&gt;})</code></td>
                <td>è¿”å›ç¬¦åˆæ¡ä»¶çš„ç¬¬ä¸€æ¡è®°å½•</td>
                <td><code>db.comment.findOne({userid:"1003"})</code></td>
            </tr>
            <tr>
                <td><code>db.collection.find({}, {&lt;projection&gt;})</code></td>
                <td><strong>æŠ•å½±æŸ¥è¯¢</strong>ï¼šè¿”å›éƒ¨åˆ†å­—æ®µ</td>
                <td><code>db.comment.find({}, {content: 1, _id: 0})</code> (åªæ˜¾ç¤º content å­—æ®µï¼Œä¸æ˜¾ç¤º _id)</td>
            </tr>
            <tr>
                <td><code>db.collection.find().limit(N)</code></td>
                <td>é™åˆ¶è¿”å›æ¡æ•°</td>
                <td><code>db.comment.find().limit(2)</code></td>
            </tr>
            <tr>
                <td><code>db.collection.find().skip(N)</code></td>
                <td>è·³è¿‡æŒ‡å®šæ¡æ•°</td>
                <td><code>db.comment.find().skip(2)</code></td>
            </tr>
            <tr>
                <td><code>db.collection.find().sort({&lt;field&gt;:-1})</code></td>
                <td>æ’åº (1:å‡åº, -1:é™åº)</td>
                <td><code>db.comment.find().sort({createdatetime:-1})</code></td>
            </tr>
            <tr>
                <td><code>db.collection.count({&lt;query&gt;})</code></td>
                <td>ç»Ÿè®¡è®°å½•æ•°</td>
                <td><code>db.comment.count({userid:"1003"})</code></td>
            </tr>
        </table>

        <h4>3.3.3 ä¿®æ”¹æ–‡æ¡£ (Update)</h4>
        <p><strong>å±€éƒ¨ä¿®æ”¹ (æ¨è)</strong>ï¼šä½¿ç”¨ <code>$set</code> æ“ä½œç¬¦æ›´æ–°æŒ‡å®šå­—æ®µï¼Œä¿ç•™å…¶ä»–å­—æ®µã€‚</p>
        <pre><code>// ä¿®æ”¹ _id ä¸º 2 çš„è®°å½•ï¼Œå°† likenum è®¾ç½®ä¸º 889
db.comment.update({_id:"2"}, {$set: {likenum: NumberInt(889)}})</code></pre>
        
        <p><strong>æ‰¹é‡ä¿®æ”¹</strong>: æ·»åŠ  <code>{multi:true}</code> é€‰é¡¹ã€‚</p>
        <pre><code>// ä¿®æ”¹æ‰€æœ‰ userid ä¸º 1003 çš„ç”¨æˆ·çš„æ˜µç§°
db.comment.update(
    {userid:"1003"},
    {$set:{nickname:"å‡¯æ’’å¤§å¸"}},
    {multi:true}
)</code></pre>
        
        <p><strong>åˆ—å€¼å¢é•¿</strong>: ä½¿ç”¨ <code>$inc</code> æ“ä½œç¬¦å®ç°å­—æ®µå€¼çš„è‡ªå¢æˆ–è‡ªå‡ã€‚</p>
        <pre><code>// å¯¹ _id ä¸º 3 çš„è®°å½•ï¼Œç‚¹èµæ•°é€’å¢ 1
db.comment.update({_id:"3"}, {$inc:{likenum: NumberInt(1)}})</code></pre>

        <h4>3.3.4 åˆ é™¤æ–‡æ¡£ (Delete)</h4>
        <pre><code>// åˆ é™¤ _id ä¸º 1 çš„è®°å½•
db.comment.remove({_id:"1"})
// åˆ é™¤æ‰€æœ‰æ–‡æ¡£ï¼ˆè¯·æ…ç”¨ï¼‰
db.comment.remove({})</code></pre>

        <h3>3.4 å¸¸ç”¨å‘½ä»¤å°ç»“</h3>
        <table>
            <tr>
                <th>æè¿°</th>
                <th>å‘½ä»¤ç¤ºä¾‹</th>
            </tr>
            <tr>
                <td>é€‰æ‹©åˆ‡æ¢æ•°æ®åº“</td>
                <td><code>use articledb</code></td>
            </tr>
            <tr>
                <td>æ’å…¥æ•°æ®</td>
                <td><code>db.comment.insert({bsonæ•°æ®})</code></td>
            </tr>
            <tr>
                <td>æŸ¥è¯¢æ‰€æœ‰æ•°æ®</td>
                <td><code>db.comment.find()</code></td>
            </tr>
            <tr>
                <td>æ¡ä»¶æŸ¥è¯¢</td>
                <td><code>db.comment.find({æ¡ä»¶})</code></td>
            </tr>
            <tr>
                <td>æ¨¡ç³ŠæŸ¥è¯¢</td>
                <td><code>db.comment.find({å­—æ®µå:/æ­£åˆ™è¡¨è¾¾å¼/})</code></td>
            </tr>
            <tr>
                <td>åŒ…å«æŸ¥è¯¢</td>
                <td><code>db.comment.find({å­—æ®µå:{$in:[å€¼1, å€¼2]}})</code></td>
            </tr>
            <tr>
                <td>é€»è¾‘ä¸/æˆ–æŸ¥è¯¢</td>
                <td><code>db.comment.find({$and:[{æ¡ä»¶1},{æ¡ä»¶2}]})</code></td>
            </tr>
            <tr>
                <td>å±€éƒ¨ä¿®æ”¹</td>
                <td><code>db.comment.update({æ¡ä»¶}, {$set:{è¦ä¿®æ”¹çš„å­—æ®µ:æ•°æ®}})</code></td>
            </tr>
            <tr>
                <td>åˆ—å€¼è‡ªå¢</td>
                <td><code>db.comment.update({æ¡ä»¶}, {$inc:{è‡ªå¢çš„å­—æ®µ:æ­¥è¿›å€¼}})</code></td>
            </tr>
            <tr>
                <td>åˆ é™¤æ•°æ®</td>
                <td><code>db.comment.remove({æ¡ä»¶})</code></td>
            </tr>
        </table>

        <h2>4. ç´¢å¼• (Index)</h2>
        
        <h3>4.1 æ¦‚è¿°</h3>
        <p>ç´¢å¼•æ˜¯ç‰¹æ®Šçš„æ•°æ®ç»“æ„ï¼Œæ”¯æŒåœ¨ MongoDB ä¸­é«˜æ•ˆåœ°æ‰§è¡ŒæŸ¥è¯¢ã€‚æ²¡æœ‰ç´¢å¼•æ—¶ï¼ŒMongoDB å¿…é¡»æ‰§è¡Œ<strong>å…¨é›†åˆæ‰«æ (COLLSCAN)</strong>ï¼Œè¿™åœ¨å¤„ç†å¤§é‡æ•°æ®æ—¶æ•ˆç‡éå¸¸ä½ã€‚</p>

        <h3>4.2 ç´¢å¼•çš„ç±»å‹</h3>
        <ol>
            <li><strong>å•å­—æ®µç´¢å¼• (Single Field Index)</strong>: åœ¨æ–‡æ¡£çš„å•ä¸ªå­—æ®µä¸Šåˆ›å»ºï¼Œå‡åº (<code>1</code>) æˆ–é™åº (<code>-1</code>)ã€‚
                <p>*ç¤ºä¾‹*: <code>db.comment.createIndex({userid: 1})</code>ã€‚</p>
            </li>
            <li><strong>å¤åˆç´¢å¼• (Compound Index)</strong>: åœ¨å¤šä¸ªå­—æ®µä¸Šåˆ›å»ºï¼Œå­—æ®µé¡ºåºå…·æœ‰é‡è¦æ„ä¹‰ã€‚
                <p>*ç¤ºä¾‹*: <code>db.comment.createIndex({userid: 1, score: -1})</code> (å…ˆæŒ‰ <code>userid</code> æ­£åºï¼Œå†åœ¨æ¯ä¸ª <code>userid</code> å†…æŒ‰ <code>score</code> å€’åº)ã€‚</p>
            </li>
            <li><strong>å…¶ä»–ç´¢å¼•</strong>: åœ°ç†ç©ºé—´ç´¢å¼• (Geospatial Index)ã€æ–‡æœ¬ç´¢å¼• (Text Indexes)ã€å“ˆå¸Œç´¢å¼• (Hashed Indexes) ç­‰ã€‚</li>
        </ol>

        <h3>4.3 ç´¢å¼•çš„ç®¡ç†æ“ä½œ</h3>
        <table>
            <tr>
                <th>å‘½ä»¤</th>
                <th>æè¿°</th>
                <th>ç¤ºä¾‹</th>
            </tr>
            <tr>
                <td><code>db.collection.createIndex({&lt;spec&gt;})</code></td>
                <td>åˆ›å»ºç´¢å¼•</td>
                <td><code>db.comment.createIndex({userid: 1})</code></td>
            </tr>
            <tr>
                <td><code>db.collection.getIndexes()</code></td>
                <td>æŸ¥çœ‹é›†åˆä¸­æ‰€æœ‰ç´¢å¼•</td>
                <td><code>db.comment.getIndexes()</code></td>
            </tr>
            <tr>
                <td><code>db.collection.dropIndex(index)</code></td>
                <td>ç§»é™¤æŒ‡å®šçš„ç´¢å¼•</td>
                <td><code>db.comment.dropIndex({userid: 1})</code></td>
            </tr>
            <tr>
                <td><code>db.collection.dropIndexes()</code></td>
                <td>ç§»é™¤æ‰€æœ‰é <code>_id</code> å­—æ®µçš„ç´¢å¼•</td>
                <td><code>db.comment.dropIndexes()</code></td>
            </tr>
        </table>

        <h3>4.4 ç´¢å¼•çš„ä½¿ç”¨ (æ‰§è¡Œè®¡åˆ’)</h3>
        <p>é€šè¿‡æŸ¥çœ‹<strong>æ‰§è¡Œè®¡åˆ’ (Explain Plan)</strong> å¯ä»¥åˆ†ææŸ¥è¯¢æ€§èƒ½ã€è€—è´¹æ—¶é—´ä»¥åŠæ˜¯å¦ä½¿ç”¨äº†ç´¢å¼•ã€‚</p>
        <p><strong>è¯­æ³•</strong>:</p>
        <pre><code>db.collection.find(query,options).explain(options)</code></pre>
        <p><strong>å…³é”®ç‚¹</strong>:</p>
        <ul>
            <li><code>"stage" : "COLLSCAN"</code>: è¡¨ç¤ºæŸ¥è¯¢è¿›è¡Œäº†<strong>å…¨é›†åˆæ‰«æ</strong>ï¼Œæ•ˆç‡ä½ã€‚</li>
            <li><code>"stage" : "IXSCAN"</code>: è¡¨ç¤ºæŸ¥è¯¢æ˜¯<strong>åŸºäºç´¢å¼•çš„æ‰«æ</strong>ï¼Œæ•ˆç‡é«˜ã€‚</li>
        </ul>
        <p>*ç¤ºä¾‹: æŸ¥çœ‹æ ¹æ® <code>userid</code> æŸ¥è¯¢æ•°æ®çš„æƒ…å†µ:*</p>
        <pre><code>db.comment.find({userid:"1003"}).explain()</code></pre>
    </div>

    <div class="back-to-top" id="backToTop">â†‘</div>

    <script>
        // å›åˆ°é¡¶éƒ¨åŠŸèƒ½
        const backToTop = document.getElementById('backToTop');
        backToTop.addEventListener('click', () => {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        // æ»šåŠ¨æ—¶æ˜¾ç¤º/éšè—å›åˆ°é¡¶éƒ¨æŒ‰é’®
        window.addEventListener('scroll', () => {
            if (window.pageYOffset > 300) {
                backToTop.style.display = 'flex';
            } else {
                backToTop.style.display = 'none';
            }
        });
    </script>
</body>
</html>